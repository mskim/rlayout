COLOR_NAMES =%w[black blue brown clear cyan darkGray gray green lightGray magenta orange purple red white yellow]
COLOR_LIST = {"AliceBlue"=>"#F0F8FF", "AntiqueWhite"=>"#FAEBD7", "Aqua"=>"#00FFFF", "Aquamarine"=>"#7FFFD4", "Azure"=>"#F0FFFF", "Beige"=>"#F5F5DC", "Bisque"=>"#FFE4C4", "black"=>"#000000", "BlanchedAlmond"=>"#FFEBCD", "Blue"=>"#0000FF", "BlueViolet"=>"#8A2BE2", "Brown"=>"#A52A2A", "BurlyWood"=>"#DEB887", "CadetBlue"=>"#5F9EA0", "Chartreuse"=>"#7FFF00", "Chocolate"=>"#D2691E", "Coral"=>"#FF7F50", "CornflowerBlue"=>"#6495ED", "Cornsilk"=>"#FFF8DC", "Crimson"=>"#DC143C", "Cyan"=>"#00FFFF", "DarkBlue"=>"#00008B", "DarkCyan"=>"#008B8B", "DarkGoldenRod"=>"#B8860B", "DarkGray"=>"#A9A9A9", "DarkGreen"=>"#006400", "DarkKhaki"=>"#BDB76B", "DarkMagenta"=>"#8B008B", "DarkOliveGreen"=>"#556B2F", "DarkOrange"=>"#FF8C00", "DarkOrchid"=>"#9932CC", "DarkRed"=>"#8B0000", "DarkSalmon"=>"#E9967A", "DarkSeaGreen"=>"#8FBC8F", "DarkSlateBlue"=>"#483D8B", "DarkSlateGray"=>"#2F4F4F", "DarkTurquoise"=>"#00CED1", "DarkViolet"=>"#9400D3", "DeepPink"=>"#FF1493", "DeepSkyBlue"=>"#00BFFF", "DimGray"=>"#696969", "DodgerBlue"=>"#1E90FF", "FireBrick"=>"#B22222", "FloralWhite"=>"#FFFAF0", "ForestGreen"=>"#228B22", "Fuchsia"=>"#FF00FF", "Gainsboro"=>"#DCDCDC", "GhostWhite"=>"#F8F8FF", "Gold"=>"#FFD700", "GoldenRod"=>"#DAA520", "Gray"=>"#808080", "Green"=>"#008000", "GreenYellow"=>"#ADFF2F", "HoneyDew"=>"#F0FFF0", "HotPink"=>"#FF69B4", "IndianRed "=>"#CD5C5C", "Indigo "=>"#4B0082", "Ivory"=>"#FFFFF0", "Khaki"=>"#F0E68C", "Lavender"=>"#E6E6FA", "LavenderBlush"=>"#FFF0F5", "LawnGreen"=>"#7CFC00", "LemonChiffon"=>"#FFFACD", "LightBlue"=>"#ADD8E6", "LightCoral"=>"#F08080", "LightCyan"=>"#E0FFFF", "LightGoldenRodYellow"=>"#FAFAD2", "LightGray"=>"#D3D3D3", "LightGreen"=>"#90EE90", "LightPink"=>"#FFB6C1", "LightSalmon"=>"#FFA07A", "LightSeaGreen"=>"#20B2AA", "LightSkyBlue"=>"#87CEFA", "LightSlateGray"=>"#778899", "LightSteelBlue"=>"#B0C4DE", "LightYellow"=>"#FFFFE0", "Lime"=>"#00FF00", "LimeGreen"=>"#32CD32", "Linen"=>"#FAF0E6", "Magenta"=>"#FF00FF", "Maroon"=>"#800000", "MediumAquaMarine"=>"#66CDAA", "MediumBlue"=>"#0000CD", "MediumOrchid"=>"#BA55D3", "MediumPurple"=>"#9370DB", "MediumSeaGreen"=>"#3CB371", "MediumSlateBlue"=>"#7B68EE", "MediumSpringGreen"=>"#00FA9A", "MediumTurquoise"=>"#48D1CC", "MediumVioletRed"=>"#C71585", "MidnightBlue"=>"#191970", "MintCream"=>"#F5FFFA", "MistyRose"=>"#FFE4E1", "Moccasin"=>"#FFE4B5", "NavajoWhite"=>"#FFDEAD", "Navy"=>"#000080", "OldLace"=>"#FDF5E6", "Olive"=>"#808000", "OliveDrab"=>"#6B8E23", "Orange"=>"#FFA500", "OrangeRed"=>"#FF4500", "Orchid"=>"#DA70D6", "PaleGoldenRod"=>"#EEE8AA", "PaleGreen"=>"#98FB98", "PaleTurquoise"=>"#AFEEEE", "PaleVioletRed"=>"#DB7093", "PapayaWhip"=>"#FFEFD5", "PeachPuff"=>"#FFDAB9", "Peru"=>"#CD853F", "Pink"=>"#FFC0CB", "Plum"=>"#DDA0DD", "PowderBlue"=>"#B0E0E6", "Purple"=>"#800080", "RebeccaPurple"=>"#663399", "Red"=>"#FF0000", "RosyBrown"=>"#BC8F8F", "RoyalBlue"=>"#4169E1", "SaddleBrown"=>"#8B4513", "Salmon"=>"#FA8072", "SandyBrown"=>"#F4A460", "SeaGreen"=>"#2E8B57", "SeaShell"=>"#FFF5EE", "Sienna"=>"#A0522D", "Silver"=>"#C0C0C0", "SkyBlue"=>"#87CEEB", "SlateBlue"=>"#6A5ACD", "SlateGray"=>"#708090", "Snow"=>"#FFFAFA", "SpringGreen"=>"#00FF7F", "SteelBlue"=>"#4682B4", "Tan"=>"#D2B48C", "Teal"=>"#008080", "Thistle"=>"#D8BFD8", "Tomato"=>"#FF6347", "Turquoise"=>"#40E0D0", "Violet"=>"#EE82EE", "Wheat"=>"#F5DEB3", "White"=>"#FFFFFF", "WhiteSmoke"=>"#F5F5F5", "Yellow"=>"#FFFF00", "YellowGreen"=>"#9ACD32"}
DARK_COLOR_LIST = []
LIGHT_COLOR_LIST =  %w[#FBF7D5 #F9DED7 #CCE1FE  #C6F8E5 #F5DCDE]

# TODO add tailwind colors
module RLayout

  module_function

  def contrasting_color(color_name)
    hex =  COLOR_LIST[upcase_first_letter(color_name)]
    unless hex
      return 'White'
    end
    # yiq_value(hex) ? "Black" : "White"
    contrast_color(hex)
  end

  # given hex color return contrasting black or white color
  def contrast_color(hex)
    red, green, blue = hex.scan(/../).map{ |c| c.to_i(16) }
    yiq = ((red * 299) + (green * 587) + (blue * 114)) / 1000
    yiq > 128 ? "black" : "white"
  end

  def yiq_value(hex)
    red,green,blue = hex.scan(/../).map{|c| c.to_i(16)}
    yiq = ((red*299) + (green*587) + (blue*114))/1000
  end

  def is_dark_color?(color_name)
    hex =  COLOR_LIST[upcase_first_letter(color_name)]
    unless hex
      puts "#{color_name} is not in the COLOR_LIST"
      return true
    end
    yiq_value(hex) <= 128
  end

  def is_light_color?(color_name)
    hex =  COLOR_LIST[upcase_first_letter(color_name)]
    unless hex
      puts "#{color_name} is not in the COLOR_LIST"
      return false
    end
    puts yiq_value(hex)
    yiq_value(hex) > 128
  end

  def random_color
    COLOR_LIST.keys.sample
  end



  def random_light_color
    pastel_tone__colors.sample
  end

  def random_dark_color
    
  end

  def color_from_cmyk_to_float(cmyk_color_string)
    cmyk_array = cmyk_color_string.split("=")
    values = cmyk_array[1].split(",")
    values.map{|e| e.to_i/100.0}
  end

  def color_from_hex(color_string)
    hex_color = color_string.gsub("#", "")
    case hex_color.size
      when 3
        colors = hex_color.scan(%r{[0-9A-Fa-f]}).map!{ |el| (el * 2).to_i(16) }
      when 6
        colors = hex_color.scan(%r<[0-9A-Fa-f]{2}>).map!{ |el| el.to_i(16) }
      when 8
        colors = hex_color.scan(%r<[0-9A-Fa-f]{2}>).map!{ |el| el.to_i(16) }
      else
        raise ArgumentError
    end
    # if colors.size == 3
    #   # RLayout.rgb_color(colors[0], colors[1], colors[2])
    # elsif colors.size == 4
    #   # RLayout.rgba_color(colors[1], colors[2], colors[3], colors[0])
    # else
    #   raise ArgumentError
    # end
    colors.map{|v| v/256.0}

  end


  def color2rgb(name)
    unless COLOR_LIST[upcase_first_letter(name)]
      return RLayout.hex2rgb(COLOR_LIST['Black'])
    end
    RLayout.hex2rgb(COLOR_LIST[upcase_first_letter(name)])
  end

  def color2hex(name)
    unless COLOR_LIST[upcase_first_letter(name)]
      return COLOR_LIST['Black']
    end
    COLOR_LIST[upcase_first_letter(name)]
  end

  def rgb2hex(rgb)
    rgb.map { |e| "%02x" % e }.join
  end

  def hex2rgb(hex)
    hex.gsub!(/^#/, "")
    r,g,b = hex[0..1], hex[2..3], hex[4..5]
    [r.to_i(16),g.to_i(16),b.to_i(16),]
  end

  def upcase_first_letter(name)
    return name if name.frozen?
    return name if name =~ /^[A-Z]/
    name[0] = name[0].upcase
    name
  end

  def convert_to_nscolor(color)
    return RLayout.color_from_string(color) if color.class == String
    color
  end

  def color_from_string(color_string)
    if color_string == nil || color_string==""
      return 'CMYK=0,0,0,0'
    end

    if COLOR_NAMES.include?(color_string)
      return RLayout.color_from_name(color_string)
    end

    if COLOR_LIST[color_string]
      return color2rgb(color_string)
    end
    
    if color_string =~ /^#/
      string = color_string[1..5]
      return RLayout.color_from_hex(color_string)
    end

    color_array=color_string.split("=")
    color_kind=color_array[0]
    # return black color unless color_array[1]
    unless color_kind 
      return [0,0,0,1.0]
    end
    color_values=color_array[1].split(",")
    if color_kind=~/RGB/
        # @color = NSColor.colorWithCalibratedRed(color_values[0].to_f, green:color_values[1].to_f, blue:color_values[2].to_f, alpha:color_values[3].to_f)
        return color_values.map{|e| e.to_i/256.0}  
    elsif color_kind=~/CMYK/
      return color_values.map{|e| e.to_i/100.0}  
    else
      @color = RLayout.color_from_name(color_string)
    end
    @color
  end

  def color_from_name(name)
    case name
    when "black"
      return [0,0,0,100].map{|e| e.to_i/100.0} 
    when "blue"
      return [100,100,0,0].map{|e| e.to_i/100.0} 
    when "brown"
      return [0,33.7,67.3,60.4].map{|e| e.to_i/100.0} 
    when "clear"
      return "clear"
    when "cyan"
      return [100,0,0,0].map{|e| e.to_i/100.0} 
    when "dark_gray", "darkGray"
      return [0,0,0,33.7].map{|e| e.to_i/100.0}
    when "gray"
      return [0,0,0,25].map{|e| e.to_i/100.0}
    when "green"
      return [100,0,100,0].map{|e| e.to_i/100.0}
    when "light_gray", "lightGray"
      return [0,0,0,17.3].map{|e| e.to_i/100.0}
    when "magenta"
      return [0,100,0,0].map{|e| e.to_i/100.0}
    when "orange"
      return [0,69,100,0].map{|e| e.to_i/100.0}
    when "purple"
      return [29,52,0,33.7].map{|e| e.to_i/100.0}
    when "red"
      return [0,84.5,80.1,19.2].map{|e| e.to_i/100.0} 
    when "white"
      return [0,0,0,0].map{|e| e.to_i/100.0}
    when "yellow"
      return [0,0,100,0].map{|e| e.to_i/100.0}
    else
      return [0,0,0,0]
    end
  end

  def rgb_color(r,g,b)
    # RLayout.rgba_color(r,g,b,1)
    "rgb(#{r},#{g},#{b})"
  end

  # @return [UIcolor]
  def rgba_color(r,g,b,a)
    r,g,b = [r,g,b].map { |i| i / 255.0}
    if a > 1.0
      a = a / 255.0
    end
    "rgba(#{r},#{g},#{b},#{a})"
  end



  ####### FONT ####

  def Korean_sanserif_medium
    "KoPubDotumPM"
  end

  def Korean_sanserif_bold
    "KoPubDotumPB "
  end

  def Korean_sanserif_light
    "KoPubDotumPL "
  end

  def Korean_serif_medium
    "KoPubBatangPM"
  end

  def Korean_serif_bold
    "KoPubBatangPB"
  end
end
